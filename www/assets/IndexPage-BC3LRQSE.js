import{G as R,u as U,l as I,c as N,w as C,o as T,m as d,n as o,p as y,q as V,v as a,C as i,f as l,Q as _,A as w,F as q,E as P,y as S,x,B as n,H as h}from"./index-CUBQy48D.js";import{Q as b}from"./QSkeleton-1IFk-_Wr.js";import{Q}from"./QCardSection-DxIQyhwE.js";import{Q as L}from"./QCard-DZMDY_Ca.js";import{Q as W}from"./QImg-B8fmnvHW.js";import{Q as M}from"./QChip-FfYl9lOC.js";import{Q as j}from"./QCardActions-Bw8LjsZA.js";import{Q as O}from"./QPage-DqzRJpM6.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-dark-yr8oZmB6.js";import"./use-timeout-sN3gBUuD.js";const H={class:"constrain q-pa-xs q-pt-sm"},J={class:"row items-center justify-between q-mb-xs"},K={key:0,class:"row q-col-gutter-xs"},X={key:1,class:"text-center q-pa-xl"},Y={key:2,class:"row q-col-gutter-xs"},ee={class:"text-caption text-grey-7 q-mb-xs product-brand"},te={class:"text-caption text-weight-medium q-mb-xs product-title"},se={class:"row items-center q-gutter-xs flex-wrap"},oe={key:0,class:"text-body2 text-primary text-weight-bold"},ae={key:1,class:"text-caption text-grey-7"},le={key:2,class:"text-caption text-grey-7"},ie={key:3,class:"text-caption text-grey-6 text-strike"},re={key:0,class:"text-caption text-grey-7 q-mt-xs"},ne={class:"q-ml-xs"},ce={key:0,class:"text-grey-6 q-ml-xs"},de={__name:"IndexPage",setup(ue){const z=V(),f=R(),k=U(),{products:r,isLoading:u,isEmpty:m}=I(f),$=N(()=>{const e=r.value||[];return console.log("displayProducts computed:",{productsCount:e.length,products:e,isEmpty:m.value,isLoading:u.value}),e}),p=e=>e.product_type&&typeof e.product_type=="object"?e.product_type.type||e.product_type.name||"ready_to_buy":e.product_type||e.productType||"ready_to_buy",Z=(e,s="USD")=>s==="USD"?e.current_price_usd||e.price_usd||e.price||null:s==="ZWL"?e.current_price_zwl||e.price_zwl||null:s==="ZAR"&&(e.current_price_zar||e.price_zar)||null,A=(e="USD")=>({USD:"$",ZWL:"ZWL ",ZAR:"R"})[e]||"$",c=(e,s="USD")=>{const t=Z(e,s);return t?`${A(s)}${parseFloat(t).toFixed(2)}`:null},D=e=>e.primary_image||e.image||e.image_url||e.thumbnail||"https://via.placeholder.com/500",v=e=>{z.push(`/product/${e}`)},E=async e=>{try{const s=f.getProductById(e);if(s)await k.addItem(e,1,s);else{await f.fetchProductDetails(e);const t=f.getProductById(e);t&&await k.addItem(e,1,t)}}catch(s){console.error("Error adding to cart:",s)}},B=e=>{console.log("Order to collect:",e),v(e)},F=e=>{console.log("Enquire product:",e),v(e)};return C(()=>r.value,(e,s)=>{console.log("Products changed:",{oldCount:s?.length||0,newCount:e?.length||0,newProducts:e,isEmpty:m.value,isLoading:u.value})},{deep:!0,immediate:!0}),C(u,e=>{console.log("Loading state changed:",{isLoading:e,productsCount:r.value.length,isEmpty:m.value})}),T(async()=>{if(console.log("IndexPage mounted - Current products:",{productsCount:r.value.length,products:r.value,isLoading:u.value,isEmpty:m.value}),r.value.length===0){console.log("Store is empty, fetching products...");try{await f.fetchProducts({append:!1,page:1}),console.log("After fetch - Products:",{productsCount:r.value.length,products:r.value,isLoading:u.value,isEmpty:m.value})}catch(e){console.error("Failed to fetch products from API:",e)}}else console.log("Products already loaded:",r.value.length)}),(e,s)=>(o(),d(O,{class:"bg-white"},{default:y(()=>[s[3]||(s[3]=a("div",{class:"hero-section bg-primary text-white q-pa-sm",style:{background:"linear-gradient(135deg, #063917 0%, #0077b6 100%)"}},[a("div",{class:"constrain"},[a("div",{class:"text-h6 text-weight-bold q-mb-xs"},"Welcome to ProudlyZimmart"),a("div",{class:"text-body2"},"Shop Local, Support Zimbabwe")])],-1)),a("div",H,[a("div",J,[s[0]||(s[0]=a("div",{class:"text-subtitle1 text-weight-bold"},"Featured Products",-1)),l(_,{flat:"",dense:"",size:"sm",label:"View All",color:"primary","icon-right":"arrow_forward","no-caps":"",class:"text-caption"})]),w(u)&&w(r).length===0?(o(),i("div",K,[(o(),i(q,null,P(12,t=>a("div",{key:t,class:"col-6 col-sm-4 col-md-3 col-lg-2 col-xl-2"},[l(L,{flat:"",bordered:"",class:"product-card"},{default:y(()=>[l(b,{height:"150px",square:""}),l(Q,{class:"q-pa-xs"},{default:y(()=>[l(b,{type:"text",width:"60%",class:"q-mb-xs"}),l(b,{type:"text",width:"80%"}),l(b,{type:"text",width:"40%",class:"q-mt-xs"})]),_:1})]),_:1})])),64))])):w(m)?(o(),i("div",X,[l(S,{name:"inventory_2",size:"64px",color:"grey-5"}),s[1]||(s[1]=a("div",{class:"text-h6 text-grey-6 q-mt-md"},"No products found",-1)),s[2]||(s[2]=a("div",{class:"text-body2 text-grey-7 q-mt-sm"},"Check back later for new products",-1))])):(o(),i("div",Y,[(o(!0),i(q,null,P($.value,t=>(o(),i("div",{key:t.id,class:"col-6 col-sm-4 col-md-3 col-lg-2 col-xl-2"},[l(L,{class:"product-card cursor-pointer",flat:"",bordered:"",onClick:g=>v(t.id)},{default:y(()=>[l(W,{src:D(t),alt:t.name||t.title,ratio:"1",class:"product-image"},null,8,["src","alt"]),l(Q,{class:"q-pa-xs"},{default:y(()=>[a("div",ee,n(t.brand||t.manufacturer||"ProudlyZimmart"),1),a("div",te,n(t.name||t.title),1),a("div",se,[c(t,"USD")?(o(),i("div",oe,n(c(t,"USD")),1)):x("",!0),c(t,"ZAR")?(o(),i("div",ae," ("+n(c(t,"ZAR"))+") ",1)):!c(t,"USD")&&!c(t,"ZAR")&&!c(t,"ZWL")?(o(),i("div",le,n(p(t)==="enquire"||p(t)==="promotional"?"Price on enquiry":"Contact for price"),1)):x("",!0),t.sale_price_usd?(o(),i("div",ie," $"+n(parseFloat(t.sale_price_usd).toFixed(2)),1)):x("",!0),t.discount_percentage||t.discount?(o(),d(M,{key:4,dense:"",size:"xs",color:"negative","text-color":"white",label:`-${t.discount_percentage||t.discount}%`},null,8,["label"])):x("",!0)]),t.rating||t.average_rating?(o(),i("div",re,[l(S,{name:"star",color:"amber",size:"10px"}),a("span",ne,n(t.rating||t.average_rating||0),1),t.reviews_count||t.reviews?(o(),i("span",ce," ("+n(t.reviews_count||t.reviews||0)+") ",1)):x("",!0)])):x("",!0)]),_:2},1024),l(j,{class:"q-pa-xs q-pt-none"},{default:y(()=>[p(t)==="ready_to_buy"?(o(),d(_,{key:0,flat:"",dense:"",size:"sm",color:"primary",label:"Add to Cart",icon:"shopping_cart",class:"full-width text-caption","no-caps":"",onClick:h(g=>E(t.id),["stop"])},null,8,["onClick"])):p(t)==="collect"?(o(),d(_,{key:1,flat:"",dense:"",size:"sm",color:"accent",label:"Order to Collect",icon:"store",class:"full-width text-caption","no-caps":"",onClick:h(g=>B(t.id),["stop"])},null,8,["onClick"])):p(t)==="enquire"?(o(),d(_,{key:2,flat:"",dense:"",size:"sm",color:"info",label:"Enquire Now",icon:"mail",class:"full-width text-caption","no-caps":"",onClick:h(g=>F(t.id),["stop"])},null,8,["onClick"])):p(t)==="promotional"?(o(),d(_,{key:3,flat:"",dense:"",size:"sm",color:"secondary",label:"Learn More",icon:"info",class:"full-width text-caption","no-caps":"",onClick:h(g=>v(t.id),["stop"])},null,8,["onClick"])):(o(),d(_,{key:4,flat:"",dense:"",size:"sm",color:"primary",label:"View Details",icon:"visibility",class:"full-width text-caption","no-caps":"",onClick:h(g=>v(t.id),["stop"])},null,8,["onClick"]))]),_:2},1024)]),_:2},1032,["onClick"])]))),128))]))])]),_:1}))}},ke=G(de,[["__scopeId","data-v-cfc03486"]]);export{ke as default};
