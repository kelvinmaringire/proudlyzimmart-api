import{k as G,r as d,c as P,m as V,n as L,p as r,q as S,t as T,v as s,f as l,Q as h,A as E,z as f,y as c,K as w,Z as A}from"./index-CUBQy48D.js";import{Q as _}from"./QSeparator-es0GegHz.js";import{Q as k}from"./QInput-SjOosiTB.js";import{Q as I}from"./QCheckbox-CwNH7dAi.js";import{Q as R}from"./QForm-DG6vkUlw.js";import{Q as O}from"./QCard-DZMDY_Ca.js";import{Q as z}from"./QPage-DqzRJpM6.js";import{s as B}from"./socialAuth-DG69hOk5.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-dark-yr8oZmB6.js";import"./focus-manager-BJWzFvJg.js";import"./use-checkbox-CztHn_fb.js";const $={class:"full-width q-pa-md"},N={class:"row justify-center"},F={class:"col-12 col-md-6 col-lg-4"},j={class:"q-gutter-y-md"},D={class:"row items-center q-my-md"},W={class:"col"},K={class:"col"},M={class:"row items-center justify-between"},Z={class:"text-center q-mt-lg"},H={class:"text-center q-mt-lg"},J={__name:"LoginPage",setup(X){const m="1009966009322-kebt3tmc0st8udl6aqr4si8s60dh6vdc.apps.googleusercontent.com",g=S(),p=G(),u=d(""),y=d(""),v=d(!1),b=d(!1),n=P(()=>p.isLoading),a=d(null),x=()=>g.currentRoute.value.query.redirect||{name:"dashboard"},q=async()=>{try{const o=u.value.includes("@"),e={password:y.value,...o?{email:u.value}:{username:u.value}};await p.login(e),await A();try{await g.replace(x())}catch(i){console.error("Router redirect error:",i);const t=g.currentRoute.value.query.redirect;window.location.href=t||"/dashboard"}}catch(o){console.error("Login error:",o)}},Q=(o,e)=>{console.error(`${e} login error:`,o),(o.message==="Google sign-in failed"||o.message==="Google OAuth failed"||o.message==="Facebook login failed or was cancelled")&&p.$q?.notify({type:"negative",message:`${e} sign-in was cancelled. Please try again.`,position:"top"})},C=async()=>{a.value="google";try{console.log("=== Starting Google OAuth Flow ==="),console.log("Google Client ID:",m?`${m.substring(0,20)}...`:"NOT SET");const o=await B(m);console.log("=== Google OAuth Response ==="),console.log("Access Token Received:",o?`${o.substring(0,30)}...`:"null/undefined"),console.log("Access Token Type:",typeof o),console.log("Access Token Length:",o?o.length:0),console.log("============================"),await p.socialLoginGoogle(o),await g.push(x())}catch(o){Q(o,"Google")}finally{a.value=null}};return(o,e)=>{const i=T("router-link");return L(),V(z,{class:"flex flex-center bg-grey-1"},{default:r(()=>[s("div",$,[s("div",N,[s("div",F,[e[10]||(e[10]=s("div",{class:"text-center q-mb-lg"},[s("div",{class:"text-h5 text-weight-bold q-mb-xs"},"Welcome Back"),s("div",{class:"text-grey-6"},"Sign in to your account")],-1)),l(O,{class:"q-pa-lg shadow-2",flat:""},{default:r(()=>[s("div",j,[l(h,{outline:"",color:"blue-9",class:"full-width",loading:a.value==="google",disable:n.value||a.value!==null||!E(m),onClick:C},{default:r(()=>[l(c,{left:"",size:"20px",name:"img:https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg"}),e[4]||(e[4]=f(" Continue with Google ",-1))]),_:1},8,["loading","disable"]),s("div",D,[s("div",W,[l(_)]),e[5]||(e[5]=s("div",{class:"col-auto q-px-md text-grey-6"},"or",-1)),s("div",K,[l(_)])])]),l(R,{onSubmit:q,class:"q-gutter-y-md"},{default:r(()=>[l(k,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),outlined:"",label:"Email or Username",placeholder:"Enter your email or username",autocomplete:"username",rules:[t=>!!t||"Email or Username is required"],"lazy-rules":"",disable:n.value||a.value!==null},{prepend:r(()=>[l(c,{name:"person"})]),_:1},8,["modelValue","rules","disable"]),l(k,{modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=t=>y.value=t),type:v.value?"text":"password",outlined:"",label:"Password",placeholder:"Enter your password",autocomplete:"current-password",rules:[t=>!!t||"Password is required",t=>t.length>=6||"Password must be at least 6 characters"],"lazy-rules":"",disable:n.value||a.value!==null},{prepend:r(()=>[l(c,{name:"lock"})]),append:r(()=>[l(c,{name:v.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[1]||(e[1]=t=>v.value=!v.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules","disable"]),s("div",M,[l(I,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=t=>b.value=t),label:"Remember me",color:"primary",disable:n.value||a.value!==null},null,8,["modelValue","disable"]),l(i,{to:"/forgot-password",class:w(["text-primary text-no-underline",{"text-grey-5":n.value||a.value!==null}])},{default:r(()=>[...e[6]||(e[6]=[f(" Forgot password? ",-1)])]),_:1},8,["class"])]),l(h,{type:"submit",color:"primary",class:"full-width q-mt-md",label:"Sign In",loading:n.value,disable:a.value!==null},null,8,["loading","disable"]),s("div",Z,[e[8]||(e[8]=s("span",{class:"text-grey-7"},"Don't have an account? ",-1)),l(i,{to:"/register",class:w(["text-primary text-weight-medium text-no-underline",{"text-grey-5":n.value||a.value!==null}])},{default:r(()=>[...e[7]||(e[7]=[f(" Sign up now ",-1)])]),_:1},8,["class"])])]),_:1})]),_:1}),s("div",H,[l(i,{to:"/",class:w(["text-grey-7 text-no-underline",{"text-grey-5":n.value||a.value!==null}])},{default:r(()=>[l(c,{name:"arrow_back",size:"16px"}),e[9]||(e[9]=f(" Back to home ",-1))]),_:1},8,["class"])])])])])]),_:1})}}},ce=U(J,[["__scopeId","data-v-22825df3"]]);export{ce as default};
