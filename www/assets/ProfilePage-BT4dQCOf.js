import{k as g,r as f,c as V,o as P,m as v,n as m,p as n,v as t,f as l,a1 as Q,C as w,y as u,Q as p}from"./index-Btp_LviN.js";import{Q as d}from"./QInput-BmIudfcp.js";import{Q as q}from"./QForm-Cgr1mS7P.js";import{Q as U}from"./QCardSection-DYSmIbuQ.js";import{Q as x}from"./QCard-eEP12_XI.js";import{Q as k}from"./QPage-M0-PEYmf.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-dark-COX_BI4o.js";import"./focus-manager-BJWzFvJg.js";const E={class:"row justify-center"},S={class:"col-12 col-md-8 col-lg-6"},z={class:"text-center q-mb-lg"},B=["src"],F={class:"row q-col-gutter-md"},I={class:"col-12 col-sm-6"},N={class:"col-12 col-sm-6"},A={class:"row q-gutter-md q-mt-lg"},L={class:"col"},D={class:"col-auto"},M={__name:"ProfilePage",setup(R){const a=g(),c=f(null),i=V(()=>a.isLoading),s=f({first_name:"",last_name:"",username:"",email:"",phone:"",bio:"",avatar:null});P(async()=>{if(a.user)s.value={first_name:a.user.first_name||"",last_name:a.user.last_name||"",username:a.user.username||"",email:a.user.email||"",phone:a.user.phone||"",bio:a.user.bio||"",avatar:a.user.avatar||null};else try{await a.fetchUserProfile(),a.user&&(s.value={first_name:a.user.first_name||"",last_name:a.user.last_name||"",username:a.user.username||"",email:a.user.email||"",phone:a.user.phone||"",bio:a.user.bio||"",avatar:a.user.avatar||null})}catch(o){console.error("Error fetching profile:",o)}});const _=()=>{c.value?.click()},b=o=>{const r=o.target.files?.[0];if(r){const e=new FileReader;e.onload=y=>{s.value.avatar=y.target.result},e.readAsDataURL(r)}},h=async()=>{try{const o={...s.value};o.avatar&&o.avatar.startsWith("data:")&&delete o.avatar,await a.updateProfile(o)}catch(o){console.error("Profile update error:",o)}};return(o,r)=>(m(),v(k,{class:"q-pa-md"},{default:n(()=>[t("div",E,[t("div",S,[r[6]||(r[6]=t("div",{class:"text-h5 text-weight-bold q-mb-md"},"My Profile",-1)),l(x,{class:"shadow-2",flat:""},{default:n(()=>[l(U,null,{default:n(()=>[l(q,{onSubmit:h,class:"q-gutter-y-md"},{default:n(()=>[t("div",z,[l(Q,{size:"120px",class:"q-mb-md"},{default:n(()=>[s.value.avatar?(m(),w("img",{key:0,src:s.value.avatar,alt:"Profile picture"},null,8,B)):(m(),v(u,{key:1,name:"person",size:"80px",color:"grey-5"}))]),_:1}),t("div",null,[l(p,{flat:"",dense:"",label:"Change Photo",color:"primary",size:"sm",onClick:_}),t("input",{ref_key:"fileInput",ref:c,type:"file",accept:"image/*",style:{display:"none"},onChange:b},null,544)])]),t("div",F,[t("div",I,[l(d,{modelValue:s.value.first_name,"onUpdate:modelValue":r[0]||(r[0]=e=>s.value.first_name=e),outlined:"",label:"First Name",placeholder:"Enter your first name",rules:[e=>!!e||"First name is required"],"lazy-rules":"",disable:i.value},{prepend:n(()=>[l(u,{name:"person"})]),_:1},8,["modelValue","rules","disable"])]),t("div",N,[l(d,{modelValue:s.value.last_name,"onUpdate:modelValue":r[1]||(r[1]=e=>s.value.last_name=e),outlined:"",label:"Last Name",placeholder:"Enter your last name",rules:[e=>!!e||"Last name is required"],"lazy-rules":"",disable:i.value},{prepend:n(()=>[l(u,{name:"person"})]),_:1},8,["modelValue","rules","disable"])])]),l(d,{modelValue:s.value.username,"onUpdate:modelValue":r[2]||(r[2]=e=>s.value.username=e),outlined:"",label:"Username",placeholder:"Enter your username",rules:[e=>!!e||"Username is required",e=>e.length>=3||"Username must be at least 3 characters"],"lazy-rules":"",disable:i.value},{prepend:n(()=>[l(u,{name:"alternate_email"})]),_:1},8,["modelValue","rules","disable"]),l(d,{modelValue:s.value.email,"onUpdate:modelValue":r[3]||(r[3]=e=>s.value.email=e),outlined:"",label:"Email Address",placeholder:"Enter your email",type:"email",rules:[e=>!!e||"Email is required",e=>/.+@.+\..+/.test(e)||"Please enter a valid email"],"lazy-rules":"",disable:i.value},{prepend:n(()=>[l(u,{name:"email"})]),_:1},8,["modelValue","rules","disable"]),l(d,{modelValue:s.value.phone,"onUpdate:modelValue":r[4]||(r[4]=e=>s.value.phone=e),outlined:"",label:"Phone Number",placeholder:"Enter your phone number (optional)",disable:i.value},{prepend:n(()=>[l(u,{name:"phone"})]),_:1},8,["modelValue","disable"]),l(d,{modelValue:s.value.bio,"onUpdate:modelValue":r[5]||(r[5]=e=>s.value.bio=e),outlined:"",label:"Bio",placeholder:"Tell us about yourself (optional)",type:"textarea",rows:"3",disable:i.value},{prepend:n(()=>[l(u,{name:"description"})]),_:1},8,["modelValue","disable"]),t("div",A,[t("div",L,[l(p,{type:"submit",color:"primary",class:"full-width",label:"Save Changes",loading:i.value},null,8,["loading"])]),t("div",D,[l(p,{flat:"",color:"primary",label:"Change Password",to:"/change-password"})])])]),_:1})]),_:1})]),_:1})])])]),_:1}))}},Y=C(M,[["__scopeId","data-v-22155d83"]]);export{Y as default};
