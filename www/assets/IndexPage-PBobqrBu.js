import{l as H,r as U,c as w,w as G,o as J,m as f,n as l,p as n,q as K,v as o,C as d,x as p,f as s,y as v,A as i,F as M,E as C,Q as k,z as O,B as h,H as W}from"./index-Btp_LviN.js";import{Q as X}from"./QInput-BmIudfcp.js";import{Q as x}from"./QChip-BdcSrHRA.js";import{Q as _}from"./QSkeleton-BLSumLVn.js";import{Q}from"./QCardSection-DYSmIbuQ.js";import{Q as V}from"./QCard-eEP12_XI.js";import{Q as Y}from"./QImg-BeS8y-QW.js";import{Q as ee}from"./QCardActions-BJK3BtK1.js";import{Q as te}from"./QPage-M0-PEYmf.js";import{u as se}from"./manufacturers-store-DgmKyr0H.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-dark-COX_BI4o.js";import"./focus-manager-BJWzFvJg.js";import"./use-timeout-BaxCR_yz.js";const re={class:"constrain q-pa-xs q-pt-sm"},ae={class:"q-mb-sm"},le={class:"q-mb-sm"},ie={class:"row q-gutter-xs q-mb-sm"},ce={key:0,class:"row q-col-gutter-xs"},ne={key:1,class:"text-center q-pa-xl"},ue={key:2,class:"row q-col-gutter-xs"},de={class:"manufacturer-logo-container"},me={class:"full-width full-height flex flex-center bg-grey-2"},pe={class:"row items-center q-mb-xs"},ve={class:"text-caption text-weight-medium manufacturer-name"},fe={class:"text-caption text-grey-7 q-mb-xs manufacturer-description"},ge={class:"row items-center q-gutter-xs"},he={class:"text-caption text-grey-7"},ye={key:0,class:"row items-center q-gutter-xs q-mt-xs"},xe={class:"text-caption text-grey-7"},_e={key:3,class:"text-center q-mt-md"},be={__name:"IndexPage",setup(we){const F=K(),c=se(),{manufacturers:u,isLoading:g,isLoadingMore:L,isEmpty:y,hasMoreManufacturers:S,filters:r}=H(c),m=U(""),B=w(()=>u.value||[]),z=w(()=>r.value.isFeatured!==null||r.value.isVerified!==null||r.value.province!==null||r.value.city!==null||r.value.search!==null),I=w(()=>r.value.city?`${r.value.city}, ${r.value.province}`:r.value.province||""),A=e=>e.logo||e.logo_url||e.image||e.image_url||"https://via.placeholder.com/200",E=e=>{const t=e.short_description||e.description||e.bio||"";return t.length>100?t.substring(0,100)+"...":t||"No description available"},N=e=>{const t=[];return e.city&&t.push(e.city),e.province&&t.push(e.province),e.country&&e.country!=="Zimbabwe"&&t.push(e.country),t.length>0?t.join(", "):"Zimbabwe"},q=e=>{F.push(`/manufacturer/${e}`)},b=()=>{m.value.trim()===""?c.searchManufacturers(null):(clearTimeout(b.timeout),b.timeout=setTimeout(()=>{c.searchManufacturers(m.value.trim())},500))},P=()=>{m.value="",c.searchManufacturers(null)},T=()=>{const e=r.value.isFeatured===!0?null:!0;c.filterByFeatured(e)},$=()=>{const e=r.value.isVerified===!0?null:!0;c.filterByVerified(e)},D=()=>{c.filterByLocation(null,null)},Z=()=>{m.value="",c.clearFilters()},j=async()=>{await c.loadMoreManufacturers()};return G(()=>u.value,e=>{console.log("Manufacturers changed:",{manufacturersCount:e?.length||0,isEmpty:y.value,isLoading:g.value})},{deep:!0,immediate:!0}),J(async()=>{if(console.log("ManufacturersListPage mounted - Current manufacturers:",{manufacturersCount:u.value.length,manufacturers:u.value,isLoading:g.value,isEmpty:y.value}),u.value.length===0){console.log("Store is empty, fetching manufacturers...");try{await c.fetchManufacturers({append:!1,page:1}),console.log("After fetch - Manufacturers:",{manufacturersCount:u.value.length,manufacturers:u.value,isLoading:g.value,isEmpty:y.value})}catch(e){console.error("Failed to fetch manufacturers from API:",e)}}else console.log("Manufacturers already loaded:",u.value.length)}),(e,t)=>(l(),f(te,{class:"bg-white"},{default:n(()=>[t[4]||(t[4]=o("div",{class:"hero-section bg-primary text-white q-pa-sm",style:{background:"linear-gradient(135deg, #063917 0%, #0077b6 100%)"}},[o("div",{class:"constrain"},[o("div",{class:"text-h6 text-weight-bold q-mb-xs"},"Local Manufacturers"),o("div",{class:"text-body2"},"Discover Zimbabwean businesses and their products")])],-1)),o("div",re,[o("div",ae,[o("div",le,[s(X,{modelValue:m.value,"onUpdate:modelValue":[t[0]||(t[0]=a=>m.value=a),b],outlined:"",dense:"",placeholder:"Search manufacturers...",class:"full-width","bg-color":"grey-1"},{prepend:n(()=>[s(v,{name:"search",color:"primary"})]),append:n(()=>[m.value?(l(),f(v,{key:0,name:"clear",class:"cursor-pointer",onClick:P})):p("",!0)]),_:1},8,["modelValue"])]),o("div",ie,[s(x,{clickable:"",color:i(r).isFeatured?"primary":"grey-3","text-color":i(r).isFeatured?"white":"dark",icon:"star",label:"Featured",onClick:T},null,8,["color","text-color"]),s(x,{clickable:"",color:i(r).isVerified?"positive":"grey-3","text-color":i(r).isVerified?"white":"dark",icon:"verified",label:"Verified",onClick:$},null,8,["color","text-color"]),i(r).province||i(r).city?(l(),f(x,{key:0,clickable:"",color:"accent","text-color":"white",icon:"location_on",label:I.value,onClick:D},null,8,["label"])):p("",!0)])]),i(g)&&i(u).length===0?(l(),d("div",ce,[(l(),d(M,null,C(8,a=>o("div",{key:a,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[s(V,{flat:"",bordered:"",class:"manufacturer-card"},{default:n(()=>[s(_,{height:"120px",square:""}),s(Q,{class:"q-pa-xs"},{default:n(()=>[s(_,{type:"text",width:"60%",class:"q-mb-xs"}),s(_,{type:"text",width:"80%"}),s(_,{type:"text",width:"40%",class:"q-mt-xs"})]),_:1})]),_:1})])),64))])):i(y)?(l(),d("div",ne,[s(v,{name:"business",size:"64px",color:"grey-5"}),t[1]||(t[1]=o("div",{class:"text-h6 text-grey-6 q-mt-md"},"No manufacturers found",-1)),t[2]||(t[2]=o("div",{class:"text-body2 text-grey-7 q-mt-sm"},"Try adjusting your search or filters",-1)),z.value?(l(),f(k,{key:0,unelevated:"",color:"primary",label:"Clear Filters",class:"q-mt-md",onClick:Z})):p("",!0)])):(l(),d("div",ue,[(l(!0),d(M,null,C(B.value,a=>(l(),d("div",{key:a.id,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[s(V,{class:"manufacturer-card cursor-pointer",flat:"",bordered:"",onClick:R=>q(a.id)},{default:n(()=>[o("div",de,[s(Y,{src:A(a),alt:a.name,ratio:"1",class:"manufacturer-logo",fit:"contain"},{error:n(()=>[o("div",me,[s(v,{name:"business",size:"48px",color:"grey-5"})])]),_:1},8,["src","alt"]),a.is_featured?(l(),f(x,{key:0,dense:"",size:"sm",color:"primary","text-color":"white",icon:"star",class:"featured-badge"},{default:n(()=>[...t[3]||(t[3]=[O(" Featured ",-1)])]),_:1})):p("",!0)]),s(Q,{class:"q-pa-xs"},{default:n(()=>[o("div",pe,[o("div",ve,h(a.name),1),a.is_verified?(l(),f(v,{key:0,name:"verified",color:"positive",size:"xs",class:"q-ml-xs"})):p("",!0)]),o("div",fe,h(E(a)),1),o("div",ge,[s(v,{name:"location_on",size:"xs",color:"grey-6"}),o("div",he,h(N(a)),1)]),a.product_count!==void 0?(l(),d("div",ye,[s(v,{name:"inventory_2",size:"xs",color:"grey-6"}),o("div",xe,h(a.product_count)+" "+h(a.product_count===1?"product":"products"),1)])):p("",!0)]),_:2},1024),s(ee,{class:"q-pa-xs q-pt-none"},{default:n(()=>[s(k,{flat:"",dense:"",size:"sm",color:"primary",label:"View Details",icon:"visibility",class:"full-width text-caption","no-caps":"",onClick:W(R=>q(a.id),["stop"])},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"])]))),128))])),i(S)&&!i(g)?(l(),d("div",_e,[s(k,{unelevated:"",color:"primary",label:"Load More",icon:"expand_more",loading:i(L),onClick:j},null,8,["loading"])])):p("",!0)])]),_:1}))}},Ne=oe(be,[["__scopeId","data-v-3e961453"]]);export{Ne as default};
