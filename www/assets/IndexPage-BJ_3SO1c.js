import{r as q,w as T,o as F,q as R,m as b,n as r,p as d,v as s,C as i,x as u,f as t,y as p,A as a,z as g,B as m,F as w,E as k,Q as y,H as D,J as Z}from"./index-CUBQy48D.js";import{Q as $}from"./QInput-SjOosiTB.js";import{Q as O}from"./QSelect-CyocrvOr.js";import{Q as v}from"./QSkeleton-1IFk-_Wr.js";import{Q}from"./QCardSection-DxIQyhwE.js";import{Q as C}from"./QCard-DZMDY_Ca.js";import{Q as U}from"./QImg-B8fmnvHW.js";import{Q as H}from"./QCardActions-Bw8LjsZA.js";import{Q as J}from"./QPage-DqzRJpM6.js";import{u as j,a as G,b as K,c as W,d as X,e as Y}from"./useBlogUtils-Df9Z-7qP.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./use-dark-yr8oZmB6.js";import"./focus-manager-BJWzFvJg.js";import"./QChip-FfYl9lOC.js";import"./QItem-DSAA0guS.js";import"./QItemLabel-CEL4gmKB.js";import"./QMenu-D77Uo7ck.js";import"./position-engine-BHw6Gt0E.js";import"./use-timeout-sN3gBUuD.js";import"./use-prevent-scroll-CqFGNme_.js";const te={class:"constrain q-pa-md"},se={class:"row q-col-gutter-md items-center"},oe={class:"col-12 col-md-8"},ae={class:"col-12 col-md-4"},re={key:0,class:"text-body2 text-grey-7 q-mt-md"},le={key:0},ie={class:"constrain q-pa-md"},ce={key:0,class:"row q-col-gutter-md"},ne={key:1,class:"text-center q-pa-xl"},de={class:"text-body2 text-grey-6 q-mt-sm"},me={key:2,class:"text-center q-pa-xl"},ue={class:"text-h6 text-grey-6 q-mt-md"},pe={class:"text-body2 text-grey-7 q-mt-sm"},he={key:3,class:"row q-col-gutter-md"},ge={class:"absolute-full flex flex-center bg-grey-3 text-grey-8"},ye={class:"text-center"},ve={class:"absolute-bottom text-caption q-pa-xs bg-black text-white text-opacity-80"},_e={class:"text-body1 text-weight-bold q-mb-xs blog-title"},xe={key:0,class:"text-body2 text-grey-7 q-mb-sm blog-excerpt"},be={class:"row items-center q-gutter-sm q-mt-sm"},fe={key:0,class:"text-caption text-grey-6"},qe={key:1,class:"text-caption text-grey-6"},we={key:4,class:"text-center q-mt-lg"},ke={key:5,class:"text-center q-mt-md"},Qe={__name:"IndexPage",setup(Ce){const h=R(),e=j(),n=q(""),_=q("-published_date"),P=[{label:"Newest First",value:"-published_date"},{label:"Oldest First",value:"published_date"},{label:"Title A-Z",value:"title"},{label:"Title Z-A",value:"-title"},{label:"Most Views",value:"-view_count"}];T(()=>h.currentRoute.value.query,l=>{l.search&&(n.value=l.search,e.searchPosts(l.search))},{immediate:!0}),F(async()=>{const l=h.currentRoute.value.query;l.search&&(n.value=l.search),e.posts.length===0&&await e.fetchPosts()});const S=async l=>{l?(await e.searchPosts(l),h.push({query:{...h.currentRoute.value.query,search:l}})):await x()},x=async()=>{n.value="",e.clearFilters(),await e.fetchPosts();const l={...h.currentRoute.value.query};delete l.search,h.push({query:l})},B=async()=>{e.error=null,await e.fetchPosts()},I=async()=>{await e.sortPosts(_.value)},V=async()=>{await e.loadMorePosts()},f=l=>{h.push(`/stories/${l}`)},L=K,M=X,z=Y,N=W,A=G;return(l,c)=>(r(),b(J,{class:"bg-white"},{default:d(()=>[c[5]||(c[5]=s("div",{class:"hero-section bg-primary text-white"},[s("div",{class:"constrain q-pa-lg"},[s("div",{class:"text-h4 text-weight-bold q-mb-sm"},"ProudlyZimmart Stories"),s("div",{class:"text-body1 text-white text-opacity-90"}," Discover inspiring stories about Zimbabwean products, manufacturers, and our vibrant community ")])],-1)),s("div",te,[s("div",se,[s("div",oe,[t($,{modelValue:n.value,"onUpdate:modelValue":[c[0]||(c[0]=o=>n.value=o),S],outlined:"",dense:"",placeholder:"Search stories by title...","bg-color":"white",class:"full-width",debounce:"500"},{prepend:d(()=>[t(p,{name:"search",color:"primary"})]),append:d(()=>[n.value?(r(),b(p,{key:0,name:"clear",class:"cursor-pointer",onClick:x})):u("",!0)]),_:1},8,["modelValue"])]),s("div",ae,[t(O,{modelValue:_.value,"onUpdate:modelValue":[c[1]||(c[1]=o=>_.value=o),I],options:P,"option-label":"label","option-value":"value","map-options":"","emit-value":"",outlined:"",dense:"","bg-color":"white",label:"Sort by"},{prepend:d(()=>[t(p,{name:"sort",color:"primary"})]),_:1},8,["modelValue"])])]),a(e).isLoading?u("",!0):(r(),i("div",re,[g(m(a(e).totalPosts)+" "+m(a(e).totalPosts===1?"story":"stories")+" found ",1),n.value?(r(),i("span",le,'for "'+m(n.value)+'"',1)):u("",!0)]))]),s("div",ie,[a(e).isLoading&&a(e).posts.length===0?(r(),i("div",ce,[(r(),i(w,null,k(6,o=>s("div",{key:o,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[t(C,{flat:"",bordered:"",class:"blog-card"},{default:d(()=>[t(v,{height:"200px",square:""}),t(Q,null,{default:d(()=>[t(v,{type:"text",width:"60%",class:"q-mb-xs"}),t(v,{type:"text",width:"80%"}),t(v,{type:"text",width:"40%",class:"q-mt-sm"})]),_:1})]),_:1})])),64))])):a(e).error&&!a(e).isLoading?(r(),i("div",ne,[t(p,{name:"error_outline",size:"80px",color:"negative"}),c[2]||(c[2]=s("div",{class:"text-h6 text-grey-7 q-mt-md"},"Failed to load stories",-1)),s("div",de,m(a(e).error),1),t(y,{unelevated:"",color:"primary",label:"Try Again",class:"q-mt-lg","no-caps":"",onClick:B})])):a(e).isEmpty&&!a(e).error?(r(),i("div",me,[t(p,{name:"article",size:"80px",color:"grey-5"}),s("div",ue,m(n.value?"No stories found":"No stories available"),1),s("div",pe,m(n.value?"Try a different search term":"Check back later for new stories"),1),n.value?(r(),b(y,{key:0,unelevated:"",color:"primary",label:"Clear Search",class:"q-mt-lg","no-caps":"",onClick:x})):u("",!0)])):(r(),i("div",he,[(r(!0),i(w,null,k(a(e).posts,o=>(r(),i("div",{key:o.id,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[t(C,{class:"blog-card cursor-pointer",flat:"",bordered:"",onClick:E=>f(o.id)},{default:d(()=>[t(U,{src:a(L)(o),alt:o.title,ratio:"16/9",class:"blog-image",loading:"lazy",onError:a(A)},{error:d(()=>[s("div",ge,[s("div",ye,[t(p,{name:"image_not_supported",size:"48px"}),c[3]||(c[3]=s("div",{class:"text-caption q-mt-xs"},"Image not available",-1))])])]),default:d(()=>[s("div",ve,[t(p,{name:"visibility",size:"xs",class:"q-mr-xs"}),g(" "+m(o.view_count||0)+" views ",1)])]),_:2},1032,["src","alt","onError"]),t(Q,{class:"q-pa-md"},{default:d(()=>[s("div",_e,m(o.title),1),o.excerpt?(r(),i("div",xe,m(a(N)(o.excerpt,100)),1)):u("",!0),s("div",be,[o.author||o.author_name?(r(),i("div",fe,[t(p,{name:"person",size:"xs",class:"q-mr-xs"}),g(" "+m(a(M)(o)),1)])):u("",!0),o.published_date?(r(),i("div",qe,[t(p,{name:"calendar_today",size:"xs",class:"q-mr-xs"}),g(" "+m(a(z)(o.published_date)),1)])):u("",!0)])]),_:2},1024),t(H,{class:"q-pa-md q-pt-none"},{default:d(()=>[t(y,{flat:"",color:"primary",label:"Read More","icon-right":"arrow_forward","no-caps":"",class:"full-width",onClick:D(E=>f(o.id),["stop"])},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"])]))),128))])),a(e).hasMorePosts&&!a(e).isLoading?(r(),i("div",we,[t(y,{unelevated:"",color:"primary",label:"Load More Stories","icon-right":"expand_more",loading:a(e).isLoadingMore,onClick:V,"no-caps":""},null,8,["loading"])])):u("",!0),a(e).isLoadingMore?(r(),i("div",ke,[t(Z,{color:"primary",size:"md"}),c[4]||(c[4]=s("div",{class:"text-body2 text-grey-7 q-mt-sm"},"Loading more stories...",-1))])):u("",!0)])]),_:1}))}},Je=ee(Qe,[["__scopeId","data-v-96bb2fa3"]]);export{Je as default};
